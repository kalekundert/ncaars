test_find_nucleophile:
  -
    id: glycine-1
    ncaa: OC(=O)CN
    expected: 0
  -
    id: glycine-2
    ncaa: C(C(=O)O)N
    expected: 3
  -
    id: glycine-3
    ncaa: NCC(=O)O
    expected: 4
  -
    id: 3-nitrotyrosine
    ncaa: N[C@@H](CC1=CC(=C(O)C=C1)[N+]([O-])=O)C(O)=O
    #     0 1     23  45  6 7 8 9   0    1    2 3 4  5
    # It seems like the hydrogens in the above SMILES string aren't actually 
    # added to the molecule; they're just used to get the chirality right.
    expected: 14
  -
    id: β-alanine
    ncaa: O=C(O)CCN
    error:
      type: UsageError
      message:
        - can't find α-amino acid backbone
        - NCAA: O=C(O)CCN
        - query: OC(=O)CN
        - use the '--nucleophile <index>' option
  -
    id: diaminopimelic-acid
    ncaa: O=C(O)[C@@H](N)CCC[C@@H](N)C(=O)O
    #     0 1 2  3     4 567 8     9 0  1 2
    error:
      type: UsageError
      message:
        - found multiple α-amino acid moieties
        - NCAA: O=C(O)[C@@H](N)CCC[C@@H](N)C(=O)O
        - query: OC(=O)CN
        - AMP could be attached to the following atom indices: 2, 12
        - use the '--nucleophile <index>' option

test_generate_conformers_etkdg:
  -
    id: base

    alignment:
      # This is the SMILES string generated by RDKit, except I rearranged the 
      # oxygens so that O1 is single-bonded and O2 is double-bonded.
      mol: N[C@@H](CO)C(O)=O
      #    0 1     23 4 5  6

      # I downloded these coordinates from the given URL, then I rearranged the 
      # atoms to match the order in the SMILES string above.
      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: [C;!$(C(=O)O)]O

    positions:
      0: -0.7059,  1.9765,  1.2189  # ref=1
      1: -0.0184,  1.5028,  0.0103  # ref=2
      4:  0.0021, -0.0041,  0.0020  # ref=5
      5:  0.2021, -0.6662, -1.1483  # ref=6
      6: -0.1616, -0.6161,  1.0308  # ref=7

    chiral_centers:
      1: S
  -
    id: stereochemistry

    alignment:
      # `mol` is D-serine, but `ref` is still L-serine.
      mol: N[C@H](CO)C(O)=O
      #    0 1    23 4 5  6

      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: [C;!$(C(=O)O)]O

    positions:
      0: -0.7059,  1.9765,  1.2189  # ref=1
      1: -0.0184,  1.5028,  0.0103  # ref=2
      4:  0.0021, -0.0041,  0.0020  # ref=5
      5:  0.2021, -0.6662, -1.1483  # ref=6
      6: -0.1616, -0.6161,  1.0308  # ref=7

    chiral_centers:
      1: R

test_substrate_alignment:
  -
    id: base

    alignment:
      mol: N[C@@H](CO)C(O)=O
      #    0 1     23 4 5  6

      # I downloded these coordinates from the given URL, then I rearranged the 
      # atoms to match the order in the SMILES string above.
      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: [C;!$(C(=O)O)]O

    # Atom  Mol  Ref
    # ──────────────
    # N       0  0/1
    # Cα      1  1/2
    # Cβ      2  2/3
    # Oγ      3  3/4
    # C       4  4/5
    # O1      5  5/6
    # O2      6  6/7

    expected:
      anchor_indices:
        0: 0
        1: 1
        4: 4
        5: 5
        6: 6

      anchor_coords:
        0: -0.7059,  1.9765,  1.2189
        1: -0.0184,  1.5028,  0.0103
        4:  0.0021, -0.0041,  0.0020
        5:  0.2021, -0.6662, -1.1483
        6: -0.1616, -0.6161,  1.0308

      pocket_indices:
        [2, 3]

      ref_pocket_indices:
        [2, 3]
  -
    id: extra-atoms-mol

    alignment:
      # lysine
      mol: N[C@@H](CCCCN)C(O)=O
      #    0 1     23456 7 8  9

      # I downloded these coordinates from the given URL, then I rearranged the 
      # atoms to match the order in the SMILES string above.
      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: [C;!$(C(=O)O)]O

    # Atom  Mol  Ref
    # ──────────────
    # N       0  0/1
    # Cα      1  1/2
    # Cβ      2  2/3
    # Oγ      -  3/4
    # Cγ      3    -
    # Cδ      4    -
    # Cε      5    -
    # Nζ      6    -
    # C       7  4/5
    # O1      8  5/6
    # O2      9  6/7

    expected:
      anchor_indices:
        0: 0
        1: 1
        7: 4
        8: 5
        9: 6

      anchor_coords:
        0: -0.7059,  1.9765,  1.2189
        1: -0.0184,  1.5028,  0.0103
        7:  0.0021, -0.0041,  0.0020
        8:  0.2021, -0.6662, -1.1483
        9: -0.1616, -0.6161,  1.0308

      pocket_indices:
        [2, 3, 4, 5, 6]

      ref_pocket_indices:
        [2, 3]
  -
    id: atom-order-mol

    alignment:
      # This is the SMILES string from wikipedia.
      mol: C([C@@H](C(=O)O)N)O
      #    0  1     2  3 4 5 6

      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: [C;!$(C(=O)O)]O

    # Atom  Mol  Ref
    # ──────────────
    # N       5  0/1
    # Cα      1  1/2
    # Cβ      0  2/3
    # Oγ      6  3/4
    # C       2  4/5
    # O1      4  5/6
    # O2      3  6/7

    expected:
      anchor_indices:
        5: 0
        1: 1
        2: 4
        4: 5
        3: 6

      anchor_coords:
        5: -0.7059,  1.9765,  1.2189  # ref=1
        1: -0.0184,  1.5028,  0.0103  # ref=2
        2:  0.0021, -0.0041,  0.0020  # ref=5
        4:  0.2021, -0.6662, -1.1483  # ref=6
        3: -0.1616, -0.6161,  1.0308  # ref=7

      pocket_indices:
        [0, 6]

      ref_pocket_indices:
        [2, 3]
  -
    id: atom-order-ref

    alignment:
      mol: N[C@@H](CO)C(O)=O
      #    0 1     23 4 5  6

      # These are the coordinates I downloaded from the given URL, in the same 
      # order I downloaded them in.
      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   1  3  1  0  0  0  0
        >   1  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   2  6  2  0  0  0  0
        >   3  7  1  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: [C;!$(C(=O)O)]O

    # Atom  Mol  Ref
    # ──────────────
    # N       0  3/4
    # Cα      1  0/1
    # Cβ      2  2/3
    # Oγ      3  6/7
    # C       4  1/2
    # O1      5  4/5
    # O2      6  5/6

    expected:
      anchor_indices:
        0: 3
        1: 0
        4: 1
        5: 4
        6: 5

      anchor_coords:
        0: -0.7059,  1.9765,  1.2189  # ref=4
        1: -0.0184,  1.5028,  0.0103  # ref=1
        4:  0.0021, -0.0041,  0.0020  # ref=2
        5:  0.2021, -0.6662, -1.1483  # ref=5
        6: -0.1616, -0.6161,  1.0308  # ref=6

      pocket_indices:
        [2, 3]

      ref_pocket_indices:
        [2, 6]
  -
    id: atom-order-anchor

    alignment:
      mol: N[C@@H](CO)C(O)=O
      #    0 1     23 4 5  6

      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      # I just reversed this.
      anchor: OC(=O)CN

      pocket: [C;!$(C(=O)O)]O

    # Atom  Mol  Ref
    # ──────────────
    # N       0  0/1
    # Cα      1  1/2
    # Cβ      2  2/3
    # Oγ      3  3/4
    # C       4  4/5
    # O1      5  5/6
    # O2      6  6/7

    expected:
      anchor_indices:
        0: 0
        1: 1
        4: 4
        5: 5
        6: 6

      anchor_coords:
        0: -0.7059,  1.9765,  1.2189
        1: -0.0184,  1.5028,  0.0103
        4:  0.0021, -0.0041,  0.0020
        5:  0.2021, -0.6662, -1.1483
        6: -0.1616, -0.6161,  1.0308

      pocket_indices:
        [2, 3]

      ref_pocket_indices:
        [2, 3]
  -
    id: err-anchor-not-found-mol

    alignment:
      mol: N[C@@H](CCCCN)C(O)=O
      #    0 1     23456 7 8  9

      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: OC(=O)C(CO)N
      pocket: [C;!$(C(=O)O)]O

    error:
      type: UsageError
      message:
        - can't find anchor atoms in adenylated NCAA
        - adenylated NCAA: N[C@@H](CCCCN)C(O)=O
        - anchor: OC(=O)C(CO)N
  -
    id: err-anchor-not-found-ref

    alignment:
      mol: N[C@@H](CCCCN)C(O)=O
      #    0 1     23456 7 8  9

      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: OC(=O)C(CC)N
      pocket: [C;!$(C(=O)O)]O

    error:
      type: UsageError
      message:
        - can't find anchor atoms in scaffold
        - scaffold: NC(CO)C(=O)O
        - anchor: OC(=O)C(CC)N
  -
    id: err-pocket-not-found-ref

    alignment:
      mol: N[C@@H](CCCCN)C(O)=O
      #    0 1     23456 7 8  9

      ref:
        > serine
        >
        > modified from: https://tinyurl.com/p9hr9xp8
        >   7  6  0  0  0  0  0  0  0  0999 V2000
        >    -0.7059    1.9765    1.2189 N   0  0  0  0  0
        >    -0.0184    1.5028    0.0103 C   0  0  0  0  0
        >     1.4170    2.0324   -0.0006 C   0  0  0  0  0
        >     1.3983    3.4570   -0.1102 O   0  0  0  0  0
        >     0.0021   -0.0041    0.0020 C   0  0  0  0  0
        >     0.2021   -0.6662   -1.1483 O   0  0  0  0  0
        >    -0.1616   -0.6161    1.0308 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        >   3  4  1  0  0  0  0
        >   2  5  1  0  0  0  0
        >   5  6  1  0  0  0  0
        >   5  7  2  0  0  0  0
        > M  END
        > $$$$

      anchor: NCC(O)=O
      pocket: CCCCN

    error:
      type: UsageError
      message:
        - can't find pocket atoms in scaffold
        - scaffold: NC(CO)C(=O)O
        - pocket: CCCCN

test_restrain_anchor_atoms:
  -
    id: 2x-coords
    alignment:
      anchor_coords:
        0: (0, 0, 0)
        1: (3, 0, 0)

    bounds:
      - 0 7 7
      - 0 0 7
      - 0 0 0

    tol: 0

    expected:
      - 0 3 7
      - 3 0 7
      - 0 0 0
  -
    id: 3x-coords
    alignment:
      anchor_coords:
        0: (0, 0, 0)
        1: (3, 0, 0)
        2: (0, 4, 0)

    bounds:
      - 0 7 7
      - 0 0 7
      - 0 0 0

    tol: 0

    expected:
      - 0 3 4
      - 3 0 5
      - 4 5 0
  -
    id: tol
    alignment:
      anchor_coords:
        0: (0, 0, 0)
        1: (3, 0, 0)

    bounds:
      - 0 7 7
      - 0 0 7
      - 0 0 0

    tol: 1

    expected:
      - 0 4 7
      - 2 0 7
      - 0 0 0

test_restrain_pocket_atoms:
  -
    id: base
    alignment:
      mol: CO
      ref:
        > line
        >
        >
        >   2  1  0  0  0  0  0  0  0  0999 V2000
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    2.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        > M  END
        > $$$$

      anchor: C
      pocket: O

    bounds:
      - 0 7
      - 0 0

    tol: 1

    expected:
      - 0 3
      - 1 0
  -
    id: isodistant-pocket-atoms
    alignment:
      mol: OCO
      ref:
        > line
        >
        >
        >   2  1  0  0  0  0  0  0  0  0999 V2000
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    2.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        > M  END
        > $$$$

      anchor: C
      pocket: O

    bounds:
      - 0 7 7
      - 0 0 7
      - 0 0 0

    tol: 1

    expected:
      - 0 3 7
      - 1 0 3
      - 0 1 0
  -
    id: unrestrained-pocket-atoms
    alignment:
      mol: NCO
      ref:
        > line
        >
        >
        >   2  1  0  0  0  0  0  0  0  0999 V2000
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    2.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        > M  END
        > $$$$

      anchor: O
      pocket: C

    bounds:
      - 0 7 7
      - 0 0 7
      - 0 0 0

    tol: 1

    expected:
      - 0 7 7
      - 0 0 3
      - 0 1 0

test_calc_pocket_dists:
  -
    id: base
    alignment:
      mol: CO
      ref:
        > line
        >
        >
        >   2  1  0  0  0  0  0  0  0  0999 V2000
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    1.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        > M  END
        > $$$$

      anchor: C
      pocket: O

    expected:
      -
        mol_anchor_i: 0
        ref_anchor_i: 0
        ref_pocket_i: 1
        dist_topo: 1
        dist_3d: 1
  -
    id: multiple-anchor-atoms
    alignment:
      mol: CCO
      ref:
        > triangle
        >
        >
        >   3  2  0  0  0  0  0  0  0  0999 V2000
        >     3.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    4.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        > M  END
        > $$$$

      anchor: CC
      pocket: O

    expected:
      -
        mol_anchor_i: 0
        ref_anchor_i: 0
        ref_pocket_i: 2
        dist_topo: 2
        dist_3d: 5
      -
        mol_anchor_i: 1
        ref_anchor_i: 1
        ref_pocket_i: 2
        dist_topo: 1
        dist_3d: 4
  -
    id: multiple-pocket-atoms
    alignment:
      mol: CCO
      ref:
        > triangle
        >
        >
        >   3  2  0  0  0  0  0  0  0  0999 V2000
        >     3.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    4.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        > M  END
        > $$$$

      anchor: O
      pocket: CC

    expected:
      -
        mol_anchor_i: 2
        ref_anchor_i: 2
        ref_pocket_i: 0
        dist_topo: 2
        dist_3d: 5
      -
        mol_anchor_i: 2
        ref_anchor_i: 2
        ref_pocket_i: 1
        dist_topo: 1
        dist_3d: 4
  -
    id: atom-order
    alignment:
      mol: C(O)N
      ref:
        > triangle
        >
        >
        >   3  2  0  0  0  0  0  0  0  0999 V2000
        >     3.0000    0.0000    0.0000 N   0  0  0  0  0
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    4.0000    0.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   2  3  1  0  0  0  0
        > M  END
        > $$$$

      anchor: NC
      pocket: O

    expected:
      -
        mol_anchor_i: 2
        ref_anchor_i: 0
        ref_pocket_i: 2
        dist_topo: 2
        dist_3d: 5
      -
        mol_anchor_i: 0
        ref_anchor_i: 1
        ref_pocket_i: 2
        dist_topo: 1
        dist_3d: 4
  -
    id: branched
    alignment:
      mol: C(C)(C)O
      ref:
        > branched
        >
        >
        >   4  3  0  0  0  0  0  0  0  0999 V2000
        >     0.0000    0.0000    0.0000 C   0  0  0  0  0
        >     1.0000    0.0000    0.0000 C   0  0  0  0  0
        >     0.0000    1.0000    0.0000 C   0  0  0  0  0
        >     0.0000    0.0000    1.0000 O   0  0  0  0  0
        >   1  2  1  0  0  0  0
        >   1  3  1  0  0  0  0
        >   1  4  1  0  0  0  0
        > M  END
        > $$$$

      anchor: O
      pocket: CCC

    expected:
      -
        mol_anchor_i: 3
        ref_anchor_i: 3
        ref_pocket_i: 0
        dist_topo: 1
        dist_3d: 1
      -
        mol_anchor_i: 3
        ref_anchor_i: 3
        ref_pocket_i: 1
        dist_topo: 2
        dist_3d: sqrt(2)
      -
        mol_anchor_i: 3
        ref_anchor_i: 3
        ref_pocket_i: 2
        dist_topo: 2
        dist_3d: sqrt(2)
